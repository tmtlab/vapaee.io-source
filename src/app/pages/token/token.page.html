<div class="container" >



    <div class="card text-white bg-dark margin-top-md overflow-visibl" [hidden]="token?.banner">
        <div class="card-header vpe-background-card-header text-xl" [hidden]="app.device.portrait">
            <img style="height:64px; width: 64px; margin-top:-0px" [src]="token?.logolg">&nbsp;
            {{token?.title}}
        </div>
        <div class="card-header vpe-background-card-header text-xl" [hidden]="!app.device.portrait">
            <img style="height:40px; width: 40px; margin-top:-10px" [src]="token?.logolg">&nbsp;
            {{token?.title}}
        </div>
    </div>




    <div [hidden]="!token?.banner" class="card text-white bg-dark margin-top-md overflow-hidden backgroun-holder">
        <img [src]="token?.banner" style="width: 100%; height: auto">
    </div>

    <div class="margin-top-md row">

        <div class="col-lg-8 col-xl-9 d-lg-none">
            <div [hidden]="!token?.brief">
                <div class="text-xl token-description">
                    <div>
                        <span class="text-lg margin-top token-title">{{token?.title}}</span>&nbsp;
                        <a class="btn btn-sm btn-primary" target="_blank" [href]="token?.website">
                            {{local.string.visitwebsite}} 
                            <i class="material-icons"> forward </i> 
                        </a>
                    </div>
                    <div class="text-md margin-top token-brief">{{token?.brief}}</div>
                </div>
                <div class="margin-top-md margin-bottom-md">
                    <hr class="line">
                </div>            
            </div>
            <div class="margin-top-md" [hidden]="hide_edit_btn">
                <a class="btn btn-lg btn-success" (click)="editToken()">
                    <i class="material-icons">edit</i>
                    {{local.string.edittokinf}}
                </a>             
            </div>
        </div>

        <div class="col-12 d-lg-none">
            <div class="text-lg-center margin-top-md token-markets" [hidden]="editing">
                <img style="height:64px; width: 64px; margin-top:-12px" [src]="token?.logolg">&nbsp;
                {{local.merge(local.string.tknMarkets, {'symbol': token?.symbol})}}
            </div>

            <vpe-panel-markets-card-deck
                [hidden]="editing"
                (tradeMarket)="tradeMarket($event)"
                [hidebackground]="true"
                [hideheader]="true"
                [markets]="token?.markets">
            </vpe-panel-markets-card-deck>

            <div class="row">
                <div class="col-6">
                    <div class="text-center token-markets expand" [hidden]="!editing">
                        <div>
                            {{local.string.icon}}
                        </div>
                        <img style="height:24px; width: 24px; margin-top: 10px;" [src]="token?.logo">
                    </div>
                </div>
                <div class="col-6">
                    <div class="text-center token-markets" [hidden]="!editing">
                        <div>
                            {{local.string.bigicon}}
                        </div>
                        <img style="height:64px; width: 64px; margin-top: 15px;" [src]="token?.logolg">
                    </div>
                </div>
            </div>       
        </div>

        <div class="col-lg-8 col-xl-9">
            <div [hidden]="!token?.brief">
                <div class="col-12 token-description text-xl d-none d-lg-inline-block margin-top-md">
                    <div>
                        <span class="text-lg margin-top token-title">{{token?.title}}</span>&nbsp;
                        <a class="btn btn-sm btn-primary" target="_blank" [href]="token?.website">
                            {{local.string.visitwebsite}} 
                            <i class="material-icons"> forward </i> 
                        </a>
                    </div>
                    <div class="text-md margin-top token-brief">{{token?.brief}}</div>
                </div>
            </div>

            <div class="d-none d-lg-inline-block">
                <a class="btn btn-lg btn-success margin-top-md" [hidden]="hide_edit_btn" (click)="editToken()">
                    <i class="material-icons">edit</i>
                    {{local.string.edittokinf}}
                </a>                
                <a class="btn btn-lg btn-danger margin-top-md" [hidden]="!editing" (click)="quitEditing()">
                    <i class="material-icons">cancel</i>
                    Quit Editing
                </a>
            </div>

            <!-- TOKEN EDITION (init) -->
            <div class="margin-top-md" [hidden]="!editing">
                <div class="card text-white bg-dark">
                    <div class="card-header vpe-background-card-header">
                        <span class="text-lg">{{local.string.tknedition | titlecase}}</span><br>
                        <span class="text-md">{{local.string.tkneditiontxt}}</span>
                    </div>
                </div>


                <div class="margin-top-md" *ngIf="token">
                    <div class="card text-white bg-dark">
                        <div class="card-body">
                            <!-- title -->
                            <div class="form-group row">
                                <label class="col-sm-3 col-form-label nowrap">{{local.string.title|titlecase}}:</label>
                                <div class="col-sm-9" >
                                    <input class="form-control col-form-label" placeholder="title" [(ngModel)]="token.title" (ngModelChange)="onTokenInfoChange($event)">
                                </div>
                            </div>
        
                            <!-- brief -->
                            <div class="form-group row">
                                <label class="col-sm-3 col-form-label nowrap">{{local.string.about|titlecase}}:</label>
                                <div class="col-sm-9" >
                                    <textarea class="form-control col-form-label" placeholder="brief" [(ngModel)]="token.brief" (ngModelChange)="onTokenInfoChange($event)"></textarea>
                                </div>
                            </div>
        
                            <!-- website -->
                            <div class="form-group row">
                                <label class="col-sm-3 col-form-label nowrap">{{local.string.website|titlecase}}:</label>
                                <div class="col-sm-9" >
                                    <input class="form-control col-form-label" placeholder="website" [(ngModel)]="token.website" (ngModelChange)="onTokenInfoChange($event)">
                                </div>
                            </div>
        
                            <!-- banner -->
                            <div class="form-group row">
                                <label class="col-sm-3 col-form-label nowrap">{{local.string.banner|titlecase}}:</label>
                                <div class="col-sm-9" >
                                    <input class="form-control col-form-label" placeholder="banner" [(ngModel)]="token.banner" (ngModelChange)="onTokenInfoChange($event)">
                                </div>
                            </div>
        
                            <!-- logo -->
                            <div class="form-group row">
                                <label class="col-sm-3 col-form-label nowrap">{{local.string.icon|titlecase}}:</label>
                                <div class="col-sm-9" >
                                    <input class="form-control col-form-label" placeholder="logo" [(ngModel)]="token.logo" (ngModelChange)="onTokenInfoChange($event)">
                                </div>
                            </div>
        
                            <!-- logolg -->
                            <div class="form-group row">
                                <label class="col-sm-3 col-form-label nowrap">{{local.string.bigicon|titlecase}}:</label>
                                <div class="col-sm-9" >
                                    <input class="form-control col-form-label" placeholder="logolg" [(ngModel)]="token.logolg" (ngModelChange)="onTokenInfoChange($event)">
                                </div>
                            </div>
        
                            <!-- tradeable -->
                            <div class="form-group row">
                                <label class="col-sm-3 col-form-label nowrap">{{local.string.tradeable|titlecase}}:</label>
                                <div class="col-sm-9">
                                    <vpe-checkbox class="as-block" [(value)]="token.tradeable" (onChange)="token.tradeable = $event ? 1 : 0"></vpe-checkbox>
                                </div>
                            </div>
            
                            <!-- Error -->
                            <div class="form-group row">
                                <div class="col-12 margin-top" [hidden]="!error">
                                    <div class="alert alert-danger">
                                        <div class="pull-right">
                                            <button type="button" class="close text-white" (click)="clearError()">
                                                <i class="material-icons" style="font-size: 100%;">cancel</i>
                                            </button>                
                                        </div>
                                        {{error}}
                                    </div>
                                </div>
                            </div>
            
                            <!-- confirm -->
                            <div class="form-group row margin-top" [hidden]="editable">
                                <label class="col-sm-2 col-form-label nowrap"></label>
                                <div class="col-sm-10 text-right">
                                    <span class="btn btn-lg btn-danger"
                                        (click)="quitEditing()">
                                        <i class="material-icons" [hidden]="loading">cancel</i>
                                        {{local.string.cancel|titlecase}}
                                    </span>                                    
                                    <span class="btn btn-lg btn-success margin-left"
                                        (click)="confirm()">
                                        <span class="spinner-border spinner-border-sm" [hidden]="!loading"></span>
                                        <i class="material-icons" [hidden]="loading">done</i>
                                        {{local.string.confirm|titlecase}}
                                    </span>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

            

            <div class="margin-top-md card"
                *ngFor="let info of token?.data"
            >
                <div class="card-body vpe-background-card-body">
                    <!-- hr class="line" -->
                    <div class="text-lg margin-top-md" [hidden]="!info.text">{{info.text}}</div>

                    <!-- YouTube video-->
                    <div class="margin-top embed-responsive embed-responsive-16by9"
                        *ngIf="info.category == 'youtube'"
                    >
                        <iframe class="embed-responsive-item" [src]="getEmbedLink(info)" allowfullscreen></iframe>
                    </div>

                    <!-- Tweet -->
                    <div class="text-center twitter-container" [innerHTML]="info.html" *ngIf="info.category == 'twitter'"></div>

                    <!-- Image -->
                    <div class="margin-top" *ngIf="info.category == 'image'">
                        <img [src]="info?.link" style="width: 100%; height: auto">
                    </div>

                    <hr class="line">

                    <!-- Info Error -->
                    <div class="form-group row">
                        <div class="col-12 margin-top" [hidden]="!feed.error('info-' + info.id)">
                            <div class="alert alert-danger">
                                <div class="pull-right">
                                    <button type="button" class="close text-white" (click)="feed.setError('info-' + info.id, null)">
                                        <i class="material-icons" style="font-size: 100%;">cancel</i>
                                    </button>                
                                </div>
                                {{feed.error('info-' + info.id)}}
                            </div>
                        </div>
                    </div>                      

                    <div class="margin-top-md" [hidden]="info.editing">
                        <span class="btn btn-sm btn-success" (click)="info.editing = true; feed.clearError('info-' + info.id)">
                            <i class="material-icons">edit</i>
                            Edit this entry
                        </span>
                        <span class="btn btn-sm btn-danger margin-left" (click)="removeData(info)">
                            <span class="spinner-border spinner-border-sm" [hidden]="!feed.loading('info-' + info.id)"></span>
                            <i class="material-icons" [hidden]="feed.loading('info-' + info.id)">save_alt</i>
                            {{local.string.delete|titlecase}}
                        </span>                           
                    </div>
                    
                    <div class="margin-top-md" [hidden]="!info.editing">

                        <div class="form-group row">
                            <label class="col-sm-3 col-form-label nowrap">{{local.string.category | titlecase}}:</label>
                            <div class="col-sm-9">
                                
                                <div class="nav-item dropdown" placement="bottom-right" ngbDropdown>
                                    <a  class="btn btn-primary dropdown-toggle" data-toggle="dropdown" id="category">
                                        {{info.category | titlecase}}
                                        <span class="caret"></span>
                                    </a>
                                    <div class="dropdown-menu dropdown-menu-right" placement="bottom-right" aria-labelledby="category">
                                        <span class="cursor-pointer dropdown-item" (click)="info.category = 'link';">
                                            <i class="color-white material-icons vertical-align-bottom"> link </i>
                                            &nbsp; link
                                        </span>
                                        <span class="cursor-pointer dropdown-item" (click)="info.category = 'image';">
                                            <i class="color-white material-icons vertical-align-bottom"> image </i>
                                            &nbsp; image
                                        </span>
                                        <span class="cursor-pointer dropdown-item" (click)="info.category = 'twitter';">
                                            <img style="width: 24px; height: 24px; " src="/assets/img/twitter.png">
                                            &nbsp; twitter
                                        </span>
                                        <span class="cursor-pointer dropdown-item" (click)="info.category = 'youtube';">
                                            <img style="width: 24px; height: 24px; " src="/assets/img/youtube.png">
                                            &nbsp; youtube
                                        </span>
                                    </div>
                                </div>

                            </div>
                        </div>

                        

                        <div class="form-group row">
                            <label class="col-sm-3 col-form-label nowrap">Text:</label>
                            <div class="col-sm-9" >
                                <input class="form-control col-form-label" placeholder="text" [(ngModel)]="info.text" autofocus>
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-3 col-form-label nowrap">Link:</label>
                            <div class="col-sm-9" >
                                <input class="form-control col-form-label" placeholder="link" [(ngModel)]="info.link" autofocus>
                            </div>
                        </div>

                        <!-- Info Error -->
                        <div class="form-group row">
                            <div class="col-12 margin-top" [hidden]="!feed.error('info-' + info.id)">
                                <div class="alert alert-danger">
                                    <div class="pull-right">
                                        <button type="button" class="close text-white" (click)="feed.setError('info-' + info.id, null)">
                                            <i class="material-icons" style="font-size: 100%;">cancel</i>
                                        </button>                
                                    </div>
                                    {{feed.error('info-' + info.id)}}
                                </div>
                            </div>
                        </div>  
    
                        <!-- Info Save btn -->
                        <div class="form-group row">
                            <div class="col-12 margin-top text-right">
                                <span class="btn btn-sm btn-danger" (click)="info.editing = false">
                                    <i class="material-icons" [hidden]="feed.loading('info-' + info.id)">cancel</i>
                                    {{local.string.cancel|titlecase}}
                                </span>
                                <span class="btn btn-sm btn-success margin-left" (click)="confirmData(info)">
                                    <span class="spinner-border spinner-border-sm" [hidden]="!feed.loading('info-' + info.id)"></span>
                                    <i class="material-icons" [hidden]="feed.loading('info-' + info.id)">save_alt</i>
                                    {{local.string.save|titlecase}}
                                </span>
                            </div>
                        </div>

                    </div>
                    
                    <!-- editing -->
                </div>
            </div>

            <div class="margin-top-xxl"></div>

        </div>

        <div class="col-lg-4 col-xl-3 d-none d-lg-inline-block margin-top-md">
            <div class="text-center token-markets" [hidden]="editing">
                <img style="height:64px; width: 64px; margin-top:-12px" [src]="token?.logolg">&nbsp;
                {{local.merge(local.string.tknMarkets, {'symbol': token?.symbol})}}
            </div>            

            <vpe-panel-markets-card-deck
                [hidden]="editing"
                (tradeMarket)="tradeMarket($event)"
                [hidebackground]="true"
                [hideheader]="true"
                [markets]="token?.markets">
            </vpe-panel-markets-card-deck>

            <div class="text-center token-markets" [hidden]="!editing">
                <div>
                    {{local.string.icon}}
                </div>
                <img style="height:20px; width: 20px; margin-top: 10px;" [src]="token?.logo">
            </div>

            <div class="margin-top-md text-center token-markets" [hidden]="!editing">
                <div>
                    {{local.string.bigicon}}
                </div>
                <img style="height:64px; width: 64px; margin-top: 15px;" [src]="token?.logolg">
            </div>

            <div class="margin-top-md token-markets" [hidden]="!editing">
                <div>
                    Extra Data: {{token?.data.length}}
                </div>
                <div>
                    <span class="btn btn-sm btn-primary margin-top" (click)="createDataEntry()">
                        <i class="material-icons">edit</i>
                        New Data Entry
                    </span>
                </div>
            </div>


        </div>
    </div>

</div>